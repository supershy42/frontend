<!DOCTYPE html>
<html>

<head>
  <title>Supereact Hooks Test</title>
</head>

<body>
  <div id="root"></div>
  <script type="module">
    import Supereact from './index.js';

    // 카운터 컴포넌트
    function Counter(props) {
      const [lastSubmittedName, setLastSubmittedName] = Supereact.useState("");

      Supereact.useEffect(() => {
        console.log("Name changed to:", lastSubmittedName);

        // cleanup function
        return () => {
          console.log("Cleaning up effect for:", lastSubmittedName);
        };
      }, [lastSubmittedName]);

      return Supereact.createElement(
        "div",
        null,
        Supereact.createElement("input", {
          onBlur: async (e) => {
            const inputValue = e.target.value;
            try {
              const response = await fetch('https://jsonplaceholder.typicode.com/posts', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                  title: 'Nickname Update',
                  body: inputValue,
                  userId: 1
                })
              });
              const data = await response.json();
              console.log('API Response:', data);
              setLastSubmittedName(inputValue);
            } catch (error) {
              console.error('API Error:', error);
            }
          },
          placeholder: "Enter nickname"
        }),
        Supereact.createElement(
          "p",
          null,
          "Last submitted nickname: ",
          lastSubmittedName || "None"
        )
      );
    }

    // Counter 컴포넌트 렌더링
    const element = Supereact.createElement(Counter, null);
    const container = document.getElementById('root');
    Supereact.render(element, container);
  </script>
</body>

</html>